<?php
/**
 * æŠ•ç¨¿IDç¢ºèªãƒ„ãƒ¼ãƒ«
 * URL: check-post-ids.php
 */

// WordPressã‚’èª­ã¿è¾¼ã¿
$wp_config_path = '../../../wp-config.php';
if (file_exists($wp_config_path)) {
    require_once($wp_config_path);
}

global $wpdb;

// å…¨æŠ•ç¨¿IDã‚’å–å¾—
$all_posts = $wpdb->get_results(
    "SELECT ID, post_title, post_type, post_status, post_date 
     FROM {$wpdb->posts} 
     WHERE post_status = 'publish' 
     AND post_type = 'post' 
     ORDER BY ID ASC"
);

?>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” æŠ•ç¨¿IDç¢ºèªãƒ„ãƒ¼ãƒ«</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f0f8ff; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .header { background: #007cba; color: white; padding: 20px; margin: -30px -30px 30px -30px; border-radius: 10px 10px 0 0; text-align: center; }
        .post-item { background: #f8f9fa; border: 2px solid #dee2e6; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .test-link { background: #28a745; color: white; padding: 8px 15px; text-decoration: none; border-radius: 4px; margin: 5px; font-weight: bold; }
        .test-link:hover { background: #218838; }
        .current-problem { background: #ffcccc; border: 3px solid #ff0000; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” æŠ•ç¨¿IDç¢ºèªãƒ„ãƒ¼ãƒ«</h1>
            <p>WordPressãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®å…¨æŠ•ç¨¿IDã‚’è¡¨ç¤ºã—ã¾ã™</p>
        </div>

        <div style="background: #fff3cd; border: 2px solid #ffc107; padding: 20px; margin: 20px 0; border-radius: 8px;">
            <h2 style="color: #856404;">ğŸ“Š ç™ºè¦‹ã•ã‚ŒãŸæŠ•ç¨¿æ•°: <?php echo count($all_posts); ?>ä»¶</h2>
        </div>

        <?php if (empty($all_posts)): ?>
            <div style="background: #f8d7da; border: 2px solid #dc3545; padding: 20px; border-radius: 8px;">
                <h2>âŒ æŠ•ç¨¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h2>
                <p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å…¬é–‹æ¸ˆã¿ã®æŠ•ç¨¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚</p>
            </div>
        <?php else: ?>
            <?php foreach ($all_posts as $post): ?>
            <div class="post-item <?php if($post->ID == 229) echo 'current-problem'; ?>">
                <h3>
                    æŠ•ç¨¿ID: <?php echo $post->ID; ?> 
                    <?php if($post->ID == 229): ?>
                        <span style="color: #dc3545; font-weight: bold;">â† å•é¡Œã®æŠ•ç¨¿</span>
                    <?php endif; ?>
                </h3>
                <p><strong>ã‚¿ã‚¤ãƒˆãƒ«:</strong> <?php echo htmlspecialchars($post->post_title); ?></p>
                <p><strong>æŠ•ç¨¿æ—¥:</strong> <?php echo $post->post_date; ?></p>
                
                <div style="margin: 10px 0;">
                    <a href="?p=<?php echo $post->ID; ?>" class="test-link">?p=<?php echo $post->ID; ?></a>
                    <a href="?page_id=<?php echo $post->ID; ?>" class="test-link">?page_id=<?php echo $post->ID; ?></a>
                    <a href="show-post.php?id=<?php echo $post->ID; ?>" target="_blank" class="test-link">å°‚ç”¨ã‚·ã‚¹ãƒ†ãƒ </a>
                </div>
            </div>
            <?php endforeach; ?>
        <?php endif; ?>

        <div style="background: #d1ecf1; border: 2px solid #17a2b8; padding: 20px; margin: 20px 0; border-radius: 8px;">
            <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆæ‰‹é †</h2>
            <ol>
                <li><strong>æŠ•ç¨¿ID 229ä»¥å¤–</strong>ã®æŠ•ç¨¿ã®<strong>ã€Œ?p=XXXã€</strong>ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>æŠ•ç¨¿ID 229ä»¥å¤–</strong>ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ</li>
                <li><strong>ã€Œå°‚ç”¨ã‚·ã‚¹ãƒ†ãƒ ã€</strong>ãƒªãƒ³ã‚¯ã¯æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</li>
            </ol>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <a href="javascript:history.back()" style="background: #6c757d; color: white; padding: 15px 25px; text-decoration: none; border-radius: 8px;">â† æˆ»ã‚‹</a>
        </div>
    </div>
</body>
</html>