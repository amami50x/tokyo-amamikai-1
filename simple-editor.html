<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€å®Œå…¨ç‰ˆã€‘Google Docsé¢¨ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</title>
    <!-- ğŸ” FILE IDENTIFIER: SIMPLE-EDITOR.HTML ğŸ” -->
    <!-- ã“ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒè¦‹ãˆãŸã‚‰ simple-editor.html ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #1976d2;
            color: white;
            padding: 10px 15px;
        }
        .header h1 {
            margin: 0;
            font-size: 18px;
        }
        .header p {
            margin: 2px 0 0 0 !important;
            font-size: 12px;
            opacity: 0.9;
        }
        .content {
            padding: 15px;
        }
        .main-editor {
            width: 100%;
        }
        
        /* é«˜æ©Ÿèƒ½ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ï¼ˆGoogle Docsé¢¨ãƒ»ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆç‰ˆï¼‰ */
        .rich-toolbar {
            border: 1px solid #c3c4c7 !important;
            border-bottom: none !important;
            padding: 4px !important;
            background: #ffffff !important;
            border-radius: 4px 4px 0 0 !important;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1) !important;
        }
        .toolbar-row {
            display: flex !important;
            align-items: center !important;
            margin-bottom: 2px !important;
            flex-wrap: wrap !important;
            gap: 1px !important;
            border-bottom: 1px solid #eee !important;
            padding-bottom: 2px !important;
        }
        .toolbar-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        .toolbar-btn {
            padding: 2px 4px !important;
            border: 1px solid #ddd !important;
            background: #f9f9f9 !important;
            border-radius: 2px !important;
            cursor: pointer !important;
            font-size: 9px !important;
            line-height: 1 !important;
            min-width: 18px !important;
            height: 18px !important;
            display: inline-flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.1s ease !important;
        }
        .toolbar-btn:hover {
            background: #e0e0e0;
            border-color: #bbb;
        }
        .toolbar-btn.active {
            background: #1976d2;
            color: white;
            border-color: #1565c0;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
        }
        .toolbar-select {
            padding: 1px 2px !important;
            border: 1px solid #ddd !important;
            border-radius: 2px !important;
            font-size: 9px !important;
            background: white !important;
            min-width: 50px !important;
            height: 18px !important;
        }
        .toolbar-select:focus {
            border-color: #1976d2;
            outline: none;
            box-shadow: 0 0 2px rgba(25,118,210,0.3);
        }
        .toolbar-separator {
            width: 1px;
            height: 14px;
            background: #ddd;
            margin: 0 1px;
        }
        .color-picker-group {
            position: relative;
            display: inline-block;
        }
        .color-btn {
            position: relative;
            overflow: visible;
            cursor: pointer;
            border: 1px solid #ccc;
            background: var(--current-color, #000000);
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.7);
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 9px;
            border-radius: 2px;
        }
        .color-btn:hover {
            border-color: #999;
            transform: scale(1.05);
        }
        .color-btn[data-type="text"] {
            background: linear-gradient(to bottom, var(--current-color, #000000) 70%, #ffffff 70%);
        }
        .color-btn[data-type="background"] {
            background: var(--current-color, #ffff00);
            color: #000;
            text-shadow: 1px 1px 1px rgba(255,255,255,0.7);
        }
        .color-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .toolbar-input {
            border: 1px solid #ddd;
            border-radius: 2px;
            padding: 1px 3px;
            font-size: 9px;
            width: 60px;
            height: 16px;
        }
        .toolbar-input:focus {
            border-color: #1976d2;
            outline: none;
            box-shadow: 0 0 2px rgba(25,118,210,0.3);
        }
        .search-group {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 2px;
            padding: 1px;
            display: flex;
            align-items: center;
            gap: 1px;
        }
        
        .editor-area {
            min-height: 500px;
            max-height: 700px;
            overflow-y: auto;
            border: 2px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
            padding: 12px;
            font-size: 16px;
            line-height: 1.6;
            font-family: 'Yu Gothic', 'Hiragino Sans', sans-serif;
            background: white;
        }
        .editor-area:focus {
            border-color: #1976d2;
            outline: none;
            box-shadow: 0 0 5px rgba(25,118,210,0.3);
        }
        .editor-area h1, .editor-area h2, .editor-area h3, 
        .editor-area h4, .editor-area h5, .editor-area h6 {
            margin: 1em 0 0.5em 0;
            font-weight: bold;
        }
        .editor-area h1 { font-size: 2em; }
        .editor-area h2 { font-size: 1.5em; }
        .editor-area h3 { font-size: 1.3em; }
        .editor-area h4 { font-size: 1.1em; }
        .editor-area h5 { font-size: 1em; }
        .editor-area h6 { font-size: 0.9em; }
        .editor-area blockquote {
            margin: 1em 0;
            padding: 10px 20px;
            border-left: 4px solid #1976d2;
            background: #f9f9f9;
            font-style: italic;
        }
        .editor-area pre {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .editor-area table {
            border-collapse: collapse;
            width: 100%;
            margin: 1em 0;
        }
        .editor-area table td, .editor-area table th {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .editor-area table th {
            background: #f2f2f2;
            font-weight: bold;
        }
        .editor-area ul, .editor-area ol {
            margin: 1em 0;
            padding-left: 40px;
        }
        .editor-area li {
            margin: 0.5em 0;
        }
        
        /* æ¤œç´¢ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
        .search-highlight {
            background-color: #ffff99;
            padding: 1px 2px;
            border-radius: 2px;
        }
        .search-highlight.search-active {
            background-color: #ff9999;
            font-weight: bold;
            animation: pulse 1s ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .buttons {
            margin-top: 10px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary {
            background: #1976d2;
            color: white;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .save-section {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #e9ecef;
            margin-top: 8px;
        }
        .save-section h3 {
            font-size: 12px;
            margin: 0 0 8px 0;
            color: #495057;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            .editor-area {
                min-height: 300px;
            }
            .toolbar-row {
                gap: 0;
            }
            .toolbar-btn {
                min-width: 16px !important;
                width: 16px !important;
                height: 16px !important;
                font-size: 8px !important;
            }
        }
    </style>
</head>
<body>
    <script>
        alert('ğŸ”¥ ç·Šæ€¥ç¢ºèª: SIMPLE-EDITOR.HTML ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸï¼');
        console.log('ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«: simple-editor.html');
        document.title = 'ğŸ”¥ã€ç¢ºèªç”¨ã€‘SIMPLE-EDITOR.HTMLå®Ÿè¡Œä¸­';
    </script>
    <!-- ğŸš¨ ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªãƒãƒŠãƒ¼ ğŸš¨ -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; background: red; color: white; text-align: center; padding: 15px; font-size: 24px; font-weight: bold; z-index: 9999; border-bottom: 5px solid yellow;">
        ğŸš¨ SIMPLE-EDITOR.HTML å®Ÿè¡Œä¸­ ğŸš¨ | ãƒ•ã‚¡ã‚¤ãƒ«: simple-editor.html | æ™‚åˆ»: 14:50
    </div>
    <div style="margin-top: 80px;"></div>
    
    <div class="container">
        <div class="header" style="background: #d32f2f !important;">
            <h1>ï¿½ Google Docsé¢¨é«˜æ©Ÿèƒ½ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã€æœ€æ–°ç‰ˆãƒ»ç¢ºèªç”¨ã€‘</h1>
            <p>å®Œå…¨ç‰ˆãƒ»ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆUIãƒ»å…¨æ©Ÿèƒ½æ­è¼‰ - 2025/11/4 14:30 æœ€çµ‚æ›´æ–° ğŸ”¥</p>
            <p style="background: yellow; color: black; padding: 5px; margin: 5px 0;">âš ï¸ ã“ã®èµ¤ã„ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¦‹ãˆã¦ã„ã‚Œã°æœ€æ–°ç‰ˆãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ âš ï¸</p>
        </div>
        
        <div class="content">

            
            <!-- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ -->
                <div class="form-group">
                    <label for="editor" style="font-size: 12px; margin-bottom: 2px;">ğŸ“ æŠ•ç¨¿å†…å®¹ï¼ˆãƒ¡ã‚¤ãƒ³ç·¨é›†ã‚¨ãƒªã‚¢ï¼‰</label>
                
                <!-- é«˜æ©Ÿèƒ½ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ï¼ˆGoogle Docsé¢¨ãƒ»4è¡Œæ§‹æˆï¼‰ -->
                <div id="rich-editor-toolbar" class="rich-toolbar">
                    
                    <!-- ç¬¬1è¡Œï¼šåŸºæœ¬ãƒ„ãƒ¼ãƒ« -->
                    <div class="toolbar-row">
                        <!-- å…ƒã«æˆ»ã™ãƒ»ã‚„ã‚Šç›´ã— -->
                        <button type="button" id="undo" class="toolbar-btn" title="å…ƒã«æˆ»ã™ (Ctrl+Z)">â†¶</button>
                        <button type="button" id="redo" class="toolbar-btn" title="ã‚„ã‚Šç›´ã— (Ctrl+Y)">â†·</button>
                        <div class="toolbar-separator"></div>
                        
                        <!-- æ¤œç´¢ãƒ»ç½®æ› -->
                        <div class="search-group">
                            <input type="text" id="searchInput" placeholder="æ¤œç´¢..." class="toolbar-input">
                            <button type="button" id="findNext" class="toolbar-btn" title="æ¬¡ã‚’æ¤œç´¢ (F3)">ğŸ”</button>
                            <button type="button" id="replace" class="toolbar-btn" title="ç½®æ›">ğŸ”„</button>
                        </div>
                        <div class="toolbar-separator"></div>
                        
                        <!-- ã‚ºãƒ¼ãƒ  -->
                        <select id="zoomLevel" class="toolbar-select" title="ã‚ºãƒ¼ãƒ ">
                            <option value="0.75">75%</option>
                            <option value="1.0" selected>100%</option>
                            <option value="1.25">125%</option>
                            <option value="1.5">150%</option>
                        </select>
                    </div>
                    
                    <!-- ç¬¬2è¡Œï¼šæ›¸å¼è¨­å®š -->
                    <div class="toolbar-row">
                        <!-- ãƒ•ã‚©ãƒ³ãƒˆé¸æŠ -->
                        <select id="fontFamily" class="toolbar-select" title="ãƒ•ã‚©ãƒ³ãƒˆ">
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="'Times New Roman', serif">Times New Roman</option>
                            <option value="'Yu Gothic', 'Hiragino Sans', sans-serif" selected>æ¸¸ã‚´ã‚·ãƒƒã‚¯</option>
                            <option value="'MS PGothic', sans-serif">MS Pã‚´ã‚·ãƒƒã‚¯</option>
                            <option value="'MS PMincho', serif">MS Pæ˜æœ</option>
                            <option value="'Meiryo', sans-serif">ãƒ¡ã‚¤ãƒªã‚ª</option>
                        </select>
                        
                        <!-- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º -->
                        <select id="fontSize" class="toolbar-select" title="ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º">
                            <option value="8px">8</option>
                            <option value="9px">9</option>
                            <option value="10px">10</option>
                            <option value="11px">11</option>
                            <option value="12px">12</option>
                            <option value="14px">14</option>
                            <option value="16px" selected>16</option>
                            <option value="18px">18</option>
                            <option value="20px">20</option>
                            <option value="24px">24</option>
                            <option value="28px">28</option>
                            <option value="32px">32</option>
                            <option value="36px">36</option>
                            <option value="48px">48</option>
                        </select>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- åŸºæœ¬æ›¸å¼ -->
                        <button type="button" id="bold" class="toolbar-btn" title="å¤ªå­— (Ctrl+B)"><strong>B</strong></button>
                        <button type="button" id="italic" class="toolbar-btn" title="æ–œä½“ (Ctrl+I)"><em>I</em></button>
                        <button type="button" id="underline" class="toolbar-btn" title="ä¸‹ç·š (Ctrl+U)"><u>U</u></button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- æ–‡å­—ãƒ»èƒŒæ™¯è‰² -->
                        <div class="color-picker-group">
                            <label for="textColor" class="color-btn" data-type="text" title="æ–‡å­—è‰²">A</label>
                            <input type="color" id="textColor" value="#000000" class="color-input">
                        </div>
                        <div class="color-picker-group">
                            <label for="backgroundColor" class="color-btn" data-type="background" title="èƒŒæ™¯è‰²">A</label>
                            <input type="color" id="backgroundColor" value="#ffff00" class="color-input">
                        </div>
                    </div>
                    
                    <!-- ç¬¬3è¡Œï¼šæ®µè½ãƒ»é…ç½® -->
                    <div class="toolbar-row">
                        <!-- æ®µè½ã‚¹ã‚¿ã‚¤ãƒ« -->
                        <select id="formatBlock" class="toolbar-select" title="æ®µè½ã‚¹ã‚¿ã‚¤ãƒ«">
                            <option value="p">æ¨™æº–ãƒ†ã‚­ã‚¹ãƒˆ</option>
                            <option value="h1">è¦‹å‡ºã—1</option>
                            <option value="h2">è¦‹å‡ºã—2</option>
                            <option value="h3">è¦‹å‡ºã—3</option>
                            <option value="h4">è¦‹å‡ºã—4</option>
                            <option value="h5">è¦‹å‡ºã—5</option>
                            <option value="h6">è¦‹å‡ºã—6</option>
                            <option value="blockquote">å¼•ç”¨</option>
                            <option value="pre">æ•´å½¢æ¸ˆã¿</option>
                        </select>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- é…ç½® -->
                        <button type="button" id="justifyLeft" class="toolbar-btn active" title="å·¦æƒãˆ">â¬…</button>
                        <button type="button" id="justifyCenter" class="toolbar-btn" title="ä¸­å¤®æƒãˆ">ğŸ¯</button>
                        <button type="button" id="justifyRight" class="toolbar-btn" title="å³æƒãˆ">â¡</button>
                        <button type="button" id="justifyFull" class="toolbar-btn" title="ä¸¡ç«¯æƒãˆ">â¬Œ</button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- ãƒªã‚¹ãƒˆ -->
                        <button type="button" id="insertOrderedList" class="toolbar-btn" title="ç•ªå·ä»˜ããƒªã‚¹ãƒˆ">1.</button>
                        <button type="button" id="insertUnorderedList" class="toolbar-btn" title="ç®‡æ¡æ›¸ããƒªã‚¹ãƒˆ">â€¢</button>
                        <button type="button" id="indent" class="toolbar-btn" title="ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆå¢—åŠ ">âŸ¶</button>
                        <button type="button" id="outdent" class="toolbar-btn" title="ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ¸›å°‘">âŸµ</button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- è¡Œé–“ -->
                        <select id="lineHeight" class="toolbar-select" title="è¡Œé–“">
                            <option value="1.0">1.0</option>
                            <option value="1.15">1.15</option>
                            <option value="1.5" selected>1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                        </select>
                    </div>
                    
                    <!-- ç¬¬4è¡Œï¼šæŒ¿å…¥ãƒ»ç‰¹æ®Šæ©Ÿèƒ½ -->
                    <div class="toolbar-row">
                        <!-- ãƒªãƒ³ã‚¯ -->
                        <button type="button" id="createLink" class="toolbar-btn" title="ãƒªãƒ³ã‚¯ã‚’æŒ¿å…¥">ğŸ”—</button>
                        <button type="button" id="unlink" class="toolbar-btn" title="ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤">ğŸ”—âƒ </button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- æŒ¿å…¥ -->
                        <button type="button" id="insertImage" class="toolbar-btn" title="ç”»åƒã‚’æŒ¿å…¥">ğŸ–¼ï¸</button>
                        <button type="button" id="insertTable" class="toolbar-btn" title="è¡¨ã‚’æŒ¿å…¥">ğŸ“Š</button>
                        <button type="button" id="insertHorizontalRule" class="toolbar-btn" title="æ°´å¹³ç·šã‚’æŒ¿å…¥">â€”</button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- æ›¸å¼ã‚’ã‚¯ãƒªã‚¢ -->
                        <button type="button" id="removeFormat" class="toolbar-btn" title="æ›¸å¼ã‚’ã‚¯ãƒªã‚¢">Tâœ•</button>
                        
                        <div class="toolbar-separator"></div>
                        
                        <!-- HTMLã‚½ãƒ¼ã‚¹è¡¨ç¤º -->
                        <button type="button" id="viewSource" class="toolbar-btn" title="HTMLã‚½ãƒ¼ã‚¹ã‚’è¡¨ç¤º/ç·¨é›†">< ></button>
                    </div>
                </div>
                
                <div id="editor" 
                     contenteditable="true" 
                     class="editor-area">ã“ã“ã«æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚Google Docsé¢¨ã®é«˜æ©Ÿèƒ½ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚’ãŠè©¦ã—ãã ã•ã„ï¼</div>
                
                <div class="buttons">
                    <button id="saveBtn" class="btn btn-primary">ğŸ’¾ å†…å®¹ã‚’ä¿å­˜</button>
                    <button id="loadBtn" class="btn btn-secondary">ğŸ“‚ èª­ã¿è¾¼ã¿</button>
                    <button id="copyBtn" class="btn btn-secondary">ğŸ“‹ HTMLã‚³ãƒ”ãƒ¼</button>
                    <button id="clearAllBtn" class="btn btn-secondary">ğŸ—‘ï¸ å…¨ã¦ã‚¯ãƒªã‚¢</button>
                </div>
            </div>
            
            <!-- ä¿å­˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¸‹éƒ¨é…ç½®ï¼‰ -->
            <div class="save-section">
                <h3>ğŸ“‹ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ä¿å­˜æ©Ÿèƒ½</h3>
                <div id="preview" style="min-height: 80px; border: 1px solid #ddd; padding: 10px; background: white; border-radius: 4px; font-size: 12px;">
                    ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
                </div>
            </div>
            
            <!-- æŠ•ç¨¿è©³ç´°è¨­å®šï¼ˆä¸‹éƒ¨ã«ç§»å‹•ï¼‰ -->
            <div class="save-section" style="margin-top: 15px;">
                <h3>ğŸ“‹ æŠ•ç¨¿è©³ç´°è¨­å®š</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label for="post_title_bottom" style="display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px;">ã‚¿ã‚¤ãƒˆãƒ«</label>
                        <input type="text" id="post_title_bottom" placeholder="æŠ•ç¨¿ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›..." style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    </div>
                    <div>
                        <label for="menu_number_bottom" style="display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px;">MENUç•ªå·</label>
                        <input type="text" id="menu_number_bottom" placeholder="MENUç•ªå·ãŒè¡¨ç¤ºã•ã‚Œã¾ã™" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; background: #f8f9fa;" readonly>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <label for="end_date_bottom" style="display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px;">æ²è¼‰æœ€çµ‚æ—¥</label>
                        <input type="date" id="end_date_bottom" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                        <small style="color: #666; font-size: 11px; margin-top: 3px; display: block;">æ²è¼‰ã‚’çµ‚äº†ã™ã‚‹æ—¥ä»˜ã‚’è¨­å®šã§ãã¾ã™</small>
                    </div>
                    <div>
                        <label for="editor_name_bottom" style="display: block; font-size: 12px; font-weight: bold; margin-bottom: 5px;">ç·¨é›†è€…</label>
                        <select id="editor_name_bottom" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                            <option value="ç®¡ç†è€…" selected>ç®¡ç†è€…</option>
                            <option value="å‰¯ç®¡ç†è€…">å‰¯ç®¡ç†è€…</option>
                            <option value="ç·¨é›†è€…">ç·¨é›†è€…</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®åˆæœŸåŒ–
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        
        // æ¤œç´¢æ©Ÿèƒ½ã®å¤‰æ•°ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰
        let currentSearchTerm = '';
        let searchResults = [];
        let currentSearchIndex = -1;
        
        // DOMãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã‹ã‚‰åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // å¼·åˆ¶çš„ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
            forceCompactStyles();
            // é«˜æ©Ÿèƒ½ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ã®åˆæœŸåŒ–
            initRichEditor();
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
            updatePreview();
        });
        
        // å¼·åˆ¶çš„ã«ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
        function forceCompactStyles() {
            // ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¼·åˆ¶é©ç”¨
            const toolbarButtons = document.querySelectorAll('.toolbar-btn');
            toolbarButtons.forEach(btn => {
                btn.style.width = '18px';
                btn.style.height = '18px';
                btn.style.fontSize = '9px';
                btn.style.padding = '2px 4px';
                btn.style.minWidth = '18px';
            });
            
            // ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¼·åˆ¶é©ç”¨
            const toolbarSelects = document.querySelectorAll('.toolbar-select');
            toolbarSelects.forEach(select => {
                select.style.height = '18px';
                select.style.fontSize = '9px';
                select.style.minWidth = '50px';
                select.style.padding = '1px 2px';
            });
            
            // ãƒ„ãƒ¼ãƒ«ãƒãƒ¼å…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ«å¼·åˆ¶é©ç”¨
            const toolbar = document.querySelector('.rich-toolbar');
            if (toolbar) {
                toolbar.style.padding = '4px';
            }
            
            const toolbarRows = document.querySelectorAll('.toolbar-row');
            toolbarRows.forEach(row => {
                row.style.marginBottom = '2px';
                row.style.gap = '1px';
                row.style.paddingBottom = '2px';
            });
        }
        
        function initRichEditor() {
            if (!editor) return;
            
            // åˆæœŸåŒ–ï¼šè‰²ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºã‚’è¨­å®š
            const textColorInput = document.getElementById('textColor');
            const textColorBtn = document.querySelector('label[for="textColor"]');
            if (textColorInput && textColorBtn) {
                updateColorButton(textColorBtn, textColorInput.value, 'text');
            }
            
            const bgColorInput = document.getElementById('backgroundColor');
            const bgColorBtn = document.querySelector('label[for="backgroundColor"]');
            if (bgColorInput && bgColorBtn) {
                updateColorButton(bgColorBtn, bgColorInput.value, 'background');
            }
            
            // ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼å†…å®¹å¤‰æ›´æ™‚ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
            editor.addEventListener('input', updatePreview);
            
            // Google Docsé¢¨ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®æ©Ÿèƒ½ã‚’è¿½åŠ 
            setupToolbarEvents();
            
            // 1ç§’å¾Œã«å†åº¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¼·åˆ¶é©ç”¨ï¼ˆä»–ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹å¹²æ¸‰å¯¾ç­–ï¼‰
            setTimeout(forceCompactStyles, 1000);
        }
        
        function setupToolbarEvents() {
            // å…ƒã«æˆ»ã™ãƒ»ã‚„ã‚Šç›´ã—
            document.getElementById('undo')?.addEventListener('click', () => {
                document.execCommand('undo', false, null);
            });
            document.getElementById('redo')?.addEventListener('click', () => {
                document.execCommand('redo', false, null);
            });
            
            // æ¤œç´¢æ©Ÿèƒ½
            document.getElementById('searchInput')?.addEventListener('input', function() {
                currentSearchTerm = this.value;
                if (currentSearchTerm.length > 0) {
                    performSearch();
                } else {
                    clearSearchHighlights();
                }
            });
            
            document.getElementById('findNext')?.addEventListener('click', () => {
                if (currentSearchTerm) {
                    findNext();
                }
            });
            
            document.getElementById('replace')?.addEventListener('click', () => {
                if (currentSearchTerm) {
                    performReplace();
                }
            });
            
            // ã‚ºãƒ¼ãƒ 
            document.getElementById('zoomLevel')?.addEventListener('change', function() {
                editor.style.zoom = this.value;
            });
            
            // ãƒ•ã‚©ãƒ³ãƒˆé¸æŠ
            document.getElementById('fontFamily')?.addEventListener('change', function() {
                editor.focus();
                document.execCommand('fontName', false, this.value);
            });
            
            // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º
            document.getElementById('fontSize')?.addEventListener('change', function() {
                const fontSize = this.value;
                const selection = window.getSelection();
                
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    const range = selection.getRangeAt(0);
                    const contents = range.extractContents();
                    const span = document.createElement('span');
                    span.style.fontSize = fontSize;
                    span.appendChild(contents);
                    range.insertNode(span);
                    
                    range.selectNodeContents(span);
                    selection.removeAllRanges();
                    selection.addRange(range);
                } else {
                    document.execCommand('fontSize', false, '7');
                    setTimeout(() => {
                        const fontElements = document.querySelectorAll('font[size="7"]');
                        fontElements.forEach(function(element) {
                            element.removeAttribute('size');
                            element.style.fontSize = fontSize;
                        });
                    }, 10);
                }
                updatePreview();
            });
            
            // åŸºæœ¬æ›¸å¼
            document.getElementById('bold')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('bold', false, null);
                updateButtonState('bold');
                updatePreview();
            });
            document.getElementById('italic')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('italic', false, null);
                updateButtonState('italic');
                updatePreview();
            });
            document.getElementById('underline')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('underline', false, null);
                updateButtonState('underline');
                updatePreview();
            });
            
            // è‰²é¸æŠ
            document.getElementById('textColor')?.addEventListener('change', function() {
                const color = this.value;
                editor.focus();
                
                const textColorBtn = document.querySelector('label[for="textColor"]');
                if (textColorBtn) {
                    updateColorButton(textColorBtn, color, 'text');
                }
                
                const selection = window.getSelection();
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    document.execCommand('styleWithCSS', false, true);
                    document.execCommand('foreColor', false, color);
                    document.execCommand('styleWithCSS', false, false);
                }
                updatePreview();
            });
            
            document.getElementById('backgroundColor')?.addEventListener('change', function() {
                const color = this.value;
                editor.focus();
                
                const bgColorBtn = document.querySelector('label[for="backgroundColor"]');
                if (bgColorBtn) {
                    updateColorButton(bgColorBtn, color, 'background');
                }
                
                const selection = window.getSelection();
                if (selection.rangeCount > 0 && !selection.isCollapsed) {
                    document.execCommand('styleWithCSS', false, true);
                    document.execCommand('hiliteColor', false, color);
                    document.execCommand('styleWithCSS', false, false);
                }
                updatePreview();
            });
            
            // æ®µè½ã‚¹ã‚¿ã‚¤ãƒ«
            document.getElementById('formatBlock')?.addEventListener('change', function() {
                const tagName = this.value;
                editor.focus();
                if (tagName === 'p') {
                    document.execCommand('formatBlock', false, 'p');
                } else {
                    document.execCommand('formatBlock', false, tagName);
                }
                this.blur();
                updatePreview();
            });
            
            // é…ç½®
            document.getElementById('justifyLeft')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('styleWithCSS', false, true);
                document.execCommand('justifyLeft', false, null);
                updateAlignButtons('justifyLeft');
                updatePreview();
            });
            document.getElementById('justifyCenter')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('styleWithCSS', false, true);
                document.execCommand('justifyCenter', false, null);
                updateAlignButtons('justifyCenter');
                updatePreview();
            });
            document.getElementById('justifyRight')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('styleWithCSS', false, true);
                document.execCommand('justifyRight', false, null);
                updateAlignButtons('justifyRight');
                updatePreview();
            });
            document.getElementById('justifyFull')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('styleWithCSS', false, true);
                document.execCommand('justifyFull', false, null);
                updateAlignButtons('justifyFull');
                updatePreview();
            });
            
            // ãƒªã‚¹ãƒˆ
            document.getElementById('insertOrderedList')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('insertOrderedList', false, null);
                updateButtonState('insertOrderedList');
                updateButtonState('insertUnorderedList');
                updatePreview();
            });
            document.getElementById('insertUnorderedList')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('insertUnorderedList', false, null);
                updateButtonState('insertUnorderedList');
                updateButtonState('insertOrderedList');
                updatePreview();
            });
            document.getElementById('indent')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('indent', false, null);
                updatePreview();
            });
            document.getElementById('outdent')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('outdent', false, null);
                updatePreview();
            });
            
            // è¡Œé–“
            document.getElementById('lineHeight')?.addEventListener('change', function() {
                const lineHeight = this.value;
                const selection = window.getSelection();
                
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    
                    if (!range.collapsed) {
                        const contents = range.extractContents();
                        const span = document.createElement('span');
                        span.style.lineHeight = lineHeight;
                        span.appendChild(contents);
                        range.insertNode(span);
                        
                        range.selectNodeContents(span);
                        selection.removeAllRanges();
                        selection.addRange(range);
                    } else {
                        let element = range.startContainer;
                        if (element.nodeType === 3) {
                            element = element.parentNode;
                        }
                        
                        while (element && element !== editor && !isBlockElement(element)) {
                            element = element.parentNode;
                        }
                        
                        if (element && element !== editor) {
                            element.style.lineHeight = lineHeight;
                        } else {
                            editor.style.lineHeight = lineHeight;
                        }
                    }
                }
                updatePreview();
            });
            
            // ãƒªãƒ³ã‚¯
            document.getElementById('createLink')?.addEventListener('click', () => {
                const url = prompt('ãƒªãƒ³ã‚¯URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
                if (url) {
                    editor.focus();
                    document.execCommand('createLink', false, url);
                    updatePreview();
                }
            });
            document.getElementById('unlink')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('unlink', false, null);
                updatePreview();
            });
            
            // ç”»åƒæŒ¿å…¥
            document.getElementById('insertImage')?.addEventListener('click', () => {
                const url = prompt('ç”»åƒURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
                if (url) {
                    editor.focus();
                    document.execCommand('insertImage', false, url);
                    
                    setTimeout(() => {
                        const images = editor.querySelectorAll('img:not([style*="max-width"])');
                        images.forEach(img => {
                            img.style.maxWidth = '100%';
                            img.style.height = 'auto';
                        });
                    }, 100);
                    updatePreview();
                }
            });
            
            // ãƒ†ãƒ¼ãƒ–ãƒ«
            document.getElementById('insertTable')?.addEventListener('click', () => {
                const rows = prompt('è¡Œæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', '3');
                const cols = prompt('åˆ—æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', '3');
                if (rows && cols) {
                    insertTable(parseInt(rows), parseInt(cols));
                    updatePreview();
                }
            });
            
            // æ°´å¹³ç·š
            document.getElementById('insertHorizontalRule')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('insertHorizontalRule', false, null);
                updatePreview();
            });
            
            // æ›¸å¼ã‚’ã‚¯ãƒªã‚¢
            document.getElementById('removeFormat')?.addEventListener('click', () => {
                editor.focus();
                document.execCommand('removeFormat', false, null);
                document.execCommand('unlink', false, null);
                updatePreview();
            });
            
            // HTMLã‚½ãƒ¼ã‚¹è¡¨ç¤º
            let sourceMode = false;
            document.getElementById('viewSource')?.addEventListener('click', () => {
                sourceMode = !sourceMode;
                if (sourceMode) {
                    const content = editor.innerHTML;
                    editor.innerHTML = '<textarea style="width:100%;height:400px;font-family:monospace;">' + 
                        escapeHtml(content) + '</textarea>';
                    document.getElementById('viewSource').classList.add('active');
                } else {
                    const textarea = editor.querySelector('textarea');
                    if (textarea) {
                        editor.innerHTML = textarea.value;
                    }
                    document.getElementById('viewSource').classList.remove('active');
                }
                updatePreview();
            });
            
            // åŸºæœ¬ãƒœã‚¿ãƒ³
            document.getElementById('saveBtn')?.addEventListener('click', () => {
                const content = editor.innerHTML;
                localStorage.setItem('richEditorContent', content);
                alert('âœ… å†…å®¹ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            });
            
            document.getElementById('loadBtn')?.addEventListener('click', () => {
                const content = localStorage.getItem('richEditorContent');
                if (content) {
                    editor.innerHTML = content;
                    updatePreview();
                    alert('ğŸ“‚ ä¿å­˜ã—ãŸå†…å®¹ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼');
                } else {
                    alert('ğŸ’­ ä¿å­˜ã•ã‚ŒãŸå†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
                }
            });
            
            document.getElementById('copyBtn')?.addEventListener('click', () => {
                const content = editor.innerHTML;
                navigator.clipboard.writeText(content).then(() => {
                    alert('ğŸ“‹ HTMLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                }).catch(() => {
                    const textarea = document.createElement('textarea');
                    textarea.value = content;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('ğŸ“‹ HTMLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                });
            });
            
            document.getElementById('clearAllBtn')?.addEventListener('click', () => {
                if (confirm('å…¨ã¦ã®å†…å®¹ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                    editor.innerHTML = 'ã“ã“ã«æ–‡ç« ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚Google Docsé¢¨ã®é«˜æ©Ÿèƒ½ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚’ãŠè©¦ã—ãã ã•ã„ï¼';
                    updatePreview();
                }
            });
            
            // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
            editor.addEventListener('keydown', function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case 'b':
                            e.preventDefault();
                            document.execCommand('bold', false, null);
                            updatePreview();
                            break;
                        case 'i':
                            e.preventDefault();
                            document.execCommand('italic', false, null);
                            updatePreview();
                            break;
                        case 'u':
                            e.preventDefault();
                            document.execCommand('underline', false, null);
                            updatePreview();
                            break;
                        case 'z':
                            if (e.shiftKey) {
                                e.preventDefault();
                                document.execCommand('redo', false, null);
                            } else {
                                e.preventDefault();
                                document.execCommand('undo', false, null);
                            }
                            break;
                        case 'y':
                            e.preventDefault();
                            document.execCommand('redo', false, null);
                            break;
                        case 'f':
                            e.preventDefault();
                            document.getElementById('searchInput')?.focus();
                            break;
                    }
                } else if (e.key === 'F3') {
                    e.preventDefault();
                    findNext();
                }
            });
            
            // ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            editor.addEventListener('keyup', updateToolbarStates);
            editor.addEventListener('mouseup', updateToolbarStates);
        }
        
        // è£œåŠ©é–¢æ•°ç¾¤
        function updatePreview() {
            if (preview && editor) {
                preview.innerHTML = editor.innerHTML || 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™';
            }
        }
        
        function updateButtonState(command) {
            const button = document.getElementById(command);
            if (button) {
                if (document.queryCommandState(command)) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            }
        }
        
        function updateAlignButtons(activeAlign) {
            const aligns = ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'];
            aligns.forEach(align => {
                const button = document.getElementById(align);
                if (button) {
                    if (align === activeAlign) {
                        button.classList.add('active');
                    } else {
                        button.classList.remove('active');
                    }
                }
            });
        }
        
        function updateToolbarStates() {
            ['bold', 'italic', 'underline'].forEach(command => {
                updateButtonState(command);
            });
            
            updateButtonState('insertOrderedList');
            updateButtonState('insertUnorderedList');
            
            const aligns = ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull'];
            let activeAlign = null;
            
            aligns.forEach(align => {
                if (document.queryCommandState(align.replace('justify', '').toLowerCase())) {
                    activeAlign = align;
                }
            });
            
            if (activeAlign) {
                updateAlignButtons(activeAlign);
            }
        }
        
        function isBlockElement(element) {
            const blockElements = ['DIV', 'P', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'BLOCKQUOTE', 'PRE', 'LI'];
            return blockElements.includes(element.tagName);
        }
        
        function insertTable(rows, cols) {
            let tableHTML = '<table border="1" style="border-collapse: collapse; width: 100%;">';
            for (let i = 0; i < rows; i++) {
                tableHTML += '<tr>';
                for (let j = 0; j < cols; j++) {
                    tableHTML += '<td style="padding: 8px; border: 1px solid #ccc;">ã‚»ãƒ«</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</table>';
            
            document.execCommand('insertHTML', false, tableHTML);
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // æ¤œç´¢æ©Ÿèƒ½
        function performSearch() {
            clearSearchHighlights();
            if (!currentSearchTerm || currentSearchTerm.length < 1) return;
            
            const text = editor.textContent;
            const regex = new RegExp(escapeRegex(currentSearchTerm), 'gi');
            let match;
            searchResults = [];
            
            while ((match = regex.exec(text)) !== null) {
                searchResults.push({
                    index: match.index,
                    length: currentSearchTerm.length
                });
            }
            
            if (searchResults.length > 0) {
                highlightSearchResults();
                currentSearchIndex = 0;
                scrollToSearchResult(0);
                
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.title = `${searchResults.length}ä»¶è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`;
                }
            } else {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.title = 'è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ';
                }
            }
        }
        
        function highlightSearchResults() {
            const html = editor.innerHTML;
            const regex = new RegExp('(' + escapeRegex(currentSearchTerm) + ')', 'gi');
            const highlightedHtml = html.replace(regex, '<mark class="search-highlight">$1</mark>');
            editor.innerHTML = highlightedHtml;
        }
        
        function clearSearchHighlights() {
            const highlights = editor.querySelectorAll('.search-highlight');
            highlights.forEach(highlight => {
                const parent = highlight.parentNode;
                parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
                parent.normalize();
            });
        }
        
        function findNext() {
            if (searchResults.length === 0) {
                performSearch();
                return;
            }
            
            currentSearchIndex = (currentSearchIndex + 1) % searchResults.length;
            scrollToSearchResult(currentSearchIndex);
        }
        
        function scrollToSearchResult(index) {
            const highlights = document.querySelectorAll('.search-highlight');
            if (highlights[index]) {
                highlights.forEach(h => h.classList.remove('search-active'));
                highlights[index].classList.add('search-active');
                highlights[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        function performReplace() {
            const replaceText = prompt('ç½®æ›å¾Œã®æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', currentSearchTerm);
            if (replaceText !== null) {
                const regex = new RegExp(escapeRegex(currentSearchTerm), 'gi');
                editor.innerHTML = editor.innerHTML.replace(regex, replaceText);
                clearSearchHighlights();
                currentSearchTerm = '';
                document.getElementById('searchInput').value = '';
                updatePreview();
            }
        }
        
        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }
        
        // è‰²ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateColorButton(button, color, type) {
            button.style.setProperty('--current-color', color);
            
            if (type === 'text') {
                button.style.background = `linear-gradient(to bottom, ${color} 70%, #ffffff 70%)`;
                const brightness = getBrightness(color);
                button.style.color = brightness > 128 ? '#000000' : '#ffffff';
                button.style.textShadow = brightness > 128 ? '1px 1px 1px rgba(0,0,0,0.3)' : '1px 1px 1px rgba(255,255,255,0.3)';
            } else if (type === 'background') {
                button.style.background = color;
                const brightness = getBrightness(color);
                button.style.color = brightness > 128 ? '#000000' : '#ffffff';
                button.style.textShadow = brightness > 128 ? '1px 1px 1px rgba(0,0,0,0.3)' : '1px 1px 1px rgba(255,255,255,0.3)';
            }
        }
        
        // è‰²ã®æ˜åº¦ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
        function getBrightness(hexColor) {
            const hex = hexColor.replace('#', '');
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            return (r * 299 + g * 587 + b * 114) / 1000;
        }
        
        // ãƒšãƒ¼ã‚¸å®Œå…¨èª­ã¿è¾¼ã¿å¾Œã«ã‚‚å†åº¦ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨
        window.addEventListener('load', function() {
            setTimeout(forceCompactStyles, 500);
        });
    </script>
</body>
</html>